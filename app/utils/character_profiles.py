# app/utils/character_profiles.py
"""
キャラクタープロファイルとオノマトペマッピング
"""
import random

# オノマトペ → キャラのマッピング（相性の良いキャラを2-3名）
CHARACTER_MAPPING = {
    # 眠気系
    "うとうと": ["スリーピー・シェフ", "サーモ・コンダクター"],
    "ぼんやり": ["フォーカス・バリスタ", "サウンド・クッカー"],
    "しゃきっ": ["フォーカス・バリスタ", "キャトラリー・バトラー"],
    
    # 疲労系
    "ぐったり": ["スリーピー・シェフ", "サーモ・コンダクター"],
    "だらだら": ["ノスタル・キッチン", "テクスチャー・アーキ"],
    "きびきび": ["フォーカス・バリスタ", "キャトラリー・バトラー"],
    
    # 不安系
    "びくびく": ["アロマ・キッチェリアン", "サーモ・コンダクター"],
    "そわそわ": ["アロマ・キッチェリアン", "テクスチャー・アーキ"],
    "のびのび": ["フレーバー・アルケミスト", "キャトラリー・バトラー"],
    
    # イライラ系
    "いらいら": ["サーモ・コンダクター", "アロマ・キッチェリアン"],
    "まあまあ": ["フレーバー・アルケミスト", "キャトラリー・バトラー"],
    "るんるん": ["サウンド・クッカー", "ノスタル・キッチン"],
}

# キャラクタープロファイル
CHARACTER_PROFILES = {
    "フォーカス・バリスタ": {
        "emoji": "☕",
        "role": "即効仕事人",
        "specialty": "集中力を即効で高める専門家",
        "food_focus": "カフェイン、噛みごたえ、香ばしさを活かした料理。コーヒー、ナッツ、全粒粉などを重視",
        "rhythm_focus": "短時間で覚醒する呼吸法、姿勢調整、目と肩のストレッチ",
        "tone": "テキパキしているが優しい。効率重視だが人を急かさない",
        "catchphrase": "集中は、正しい姿勢と香りから始まるニャ",
    },
    "サーモ・コンダクター": {
        "emoji": "🌡️",
        "role": "温度の調律師",
        "specialty": "温度で心身を調律する温度の魔術師",
        "food_focus": "温かさ or 冷たさを戦略的に使った料理。温スープ、冷製サラダ、温冷コントラスト",
        "rhythm_focus": "温感を感じる儀式、体温調整、温かい飲み物を持つ瞑想",
        "tone": "穏やかで落ち着いている。ゆったりとした語り口",
        "catchphrase": "温度が変われば、心も変わるニャ",
    },
    "アロマ・キッチェリアン": {
        "emoji": "🌿",
        "role": "香りの導師",
        "specialty": "香りで心を導く香りの導師",
        "food_focus": "ハーブ、柑橘系、スパイスを活かした香り豊かな料理。ミント、レモン、生姜など",
        "rhythm_focus": "香りを嗅ぐ瞑想、深呼吸、アロマを感じる儀式",
        "tone": "優しく包み込むような語り口。癒し系",
        "catchphrase": "香りは、心の扉を開く鍵ニャ",
    },
    "サウンド・クッカー": {
        "emoji": "🎵",
        "role": "音の料理家",
        "specialty": "音とリズムで気分を整える音の料理家",
        "food_focus": "音が楽しい食材。パリパリ、シャキシャキ、ジュワーなど食感と音を重視",
        "rhythm_focus": "リズミカルな呼吸、手拍子、音楽を聴く瞑想",
        "tone": "リズミカルで楽しい。音楽的な語り口",
        "catchphrase": "心地よい音が、心を整えるニャ",
    },
    "テクスチャー・アーキ": {
        "emoji": "✋",
        "role": "触感設計士",
        "specialty": "触感で五感を刺激する触感設計士",
        "food_focus": "食感のコントラスト。やわらかい×カリカリ、とろとろ×プチプチなど",
        "rhythm_focus": "触感を感じる瞑想、手のひらマッサージ、物に触れる儀式",
        "tone": "丁寧で繊細。五感に訴えかける語り口",
        "catchphrase": "触感は、今この瞬間を感じる入口ニャ",
    },
    "フレーバー・アルケミスト": {
        "emoji": "⚗️",
        "role": "風味の錬金術師",
        "specialty": "風味を錬金術のように調合する錬金術師",
        "food_focus": "複雑な風味の組み合わせ。甘い×酸っぱい、塩×甘など意外な組み合わせ",
        "rhythm_focus": "味覚を感じる瞑想、一口ずつ味わう儀式",
        "tone": "知的で探究心旺盛。好奇心を刺激する語り口",
        "catchphrase": "風味の魔法で、心を変えるニャ",
    },
    "ノスタル・キッチン": {
        "emoji": "🍡",
        "role": "旅する駄菓子研究家",
        "specialty": "懐かしさで心を温める旅する駄菓子研究家",
        "food_focus": "懐かしい味、駄菓子風、シンプルな味付け。きなこ、みたらし、素朴な甘さ",
        "rhythm_focus": "子供の頃を思い出す瞑想、ゆったりした呼吸、懐かしい記憶を辿る",
        "tone": "温かくノスタルジック。おばあちゃんのような優しさ",
        "catchphrase": "懐かしい味が、心をほぐすニャ",
    },
    "キャトラリー・バトラー": {
        "emoji": "🎩",
        "role": "猫専属執事",
        "specialty": "完璧なサービスで心を整える猫専属執事",
        "food_focus": "丁寧な盛り付け、上品な味付け、洗練されたシンプルさ",
        "rhythm_focus": "姿勢を正す儀式、礼儀作法を意識した呼吸、整った動作",
        "tone": "礼儀正しく丁寧。執事のような品格",
        "catchphrase": "整った環境が、心を整えるニャ",
    },
    "スリーピー・シェフ": {
        "emoji": "💤",
        "role": "昼寝導入員",
        "specialty": "眠りへ優しく導く昼寝導入員",
        "food_focus": "温かく、やわらかく、優しい味付け。温ミルク、はちみつ、バナナなど",
        "rhythm_focus": "ゆったり呼吸、体を緩める儀式、眠りを誘う瞑想",
        "tone": "とても穏やかでゆっくり。子守唄のような語り口",
        "catchphrase": "ゆっくり休むことも、大切な仕事ニャ",
    },
}

def select_character(onomatopoeia: str) -> tuple[str, dict]:
    """
    オノマトペに応じたキャラクターをランダムに選択
    
    Args:
        onomatopoeia: オノマトペ
    
    Returns:
        tuple: (キャラ名, キャラプロファイル)
    """
    # マッピングから候補を取得
    candidates = CHARACTER_MAPPING.get(onomatopoeia, ["フレーバー・アルケミスト"])
    
    # ランダムに1名選択
    selected_name = random.choice(candidates)
    
    # プロファイルを取得
    profile = CHARACTER_PROFILES.get(selected_name, CHARACTER_PROFILES["フレーバー・アルケミスト"])
    
    return selected_name, profile